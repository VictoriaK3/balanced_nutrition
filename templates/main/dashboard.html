{% extends "base.html" %}
{% load humanize %}
{% block title %}Табло – Balanced Nutrition{% endblock %}

{% block content %}
<h2 class="text-2xl font-bold mb-6">Дневни таргети</h2>

<div class="grid grid-cols-2 gap-4">
  {% for c in cards %}
    <div class="bg-white rounded shadow p-6 text-center">
      <p class="text-gray-500">{{ c.label }}</p>
      <p class="text-3xl font-semibold">
        {{ c.val|intcomma }} <span class="text-lg">{{ c.unit }}</span>
      </p>
    </div>
  {% endfor %}
</div>

<canvas id="macroChart" class="mt-10 mx-auto"></canvas>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
/* предаваме го като string и парсваме */
const data = JSON.parse('{{ macro_json|escapejs }}');

new Chart(document.getElementById('macroChart'), {
  type: 'pie',
  data: {
    labels: ['Протеин', 'Мазнини', 'Въглехидрати'],
    datasets: [{ data: data }]
  },
  options: { plugins: { legend: { position:'bottom' } } }
});
</script>
{% endblock %}
